#!/bin/sh
set -e

trap "rm -f .git/tags.$$" EXIT
dir="`git rev-parse --git-dir`"

git ls-files | \
    /usr/local/bin/ctags \
    --tag-relative \
    -L - \
    -f.git/tags.$$ \
    --language-force=python \
    --python-kinds=-ivm \
    --exclude={.tox}

mv "$dir"/tags{.$$,}
