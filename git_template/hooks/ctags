#!/bin/sh
set -e

trap "rm -f .git/tags.$$" EXIT
dir="`git rev-parse --git-dir`"

git ls-files | \
    /usr/local/bin/ctags \
    --tag-relative \
    -L - \
    -f.git/tags.$$ \
    --language-force=python \
    --python-kinds=-ivm \
    --exclude=.tox \
    --exclude=.direnv \
    --exclude=bower_components \
    --exclude=node_modules \
    --exclude=README.*

mv "$dir"/tags{.$$,}
